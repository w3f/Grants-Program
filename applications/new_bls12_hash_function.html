<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-applications/new_bls12_hash_function" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Implementation of the new hash function to BLS12 curves | Web3 Foundation Grants</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://grants.web3.foundation/applications/new_bls12_hash_function"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Implementation of the new hash function to BLS12 curves | Web3 Foundation Grants"><meta data-rh="true" name="description" content="- Team Name: Dmitrii Koshelev"><meta data-rh="true" property="og:description" content="- Team Name: Dmitrii Koshelev"><link data-rh="true" rel="icon" href="/img/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://grants.web3.foundation/applications/new_bls12_hash_function"><link data-rh="true" rel="alternate" href="https://grants.web3.foundation/applications/new_bls12_hash_function" hreflang="en"><link data-rh="true" rel="alternate" href="https://grants.web3.foundation/applications/new_bls12_hash_function" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9VKKGZO0U1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Web3 Foundation Grants" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.f3a7e75f.css">
<script src="/assets/js/runtime~main.785706f9.js" defer="defer"></script>
<script src="/assets/js/main.f737dd4d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#000;color:#ffffff" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><a target="_blank" rel="noopener noreferrer" href="https://medium.com/web3foundation/web3-foundation-ecodev-wave-26-7f145c39c2ef">Our blog post on Ecosystem Development Wave 26 is now online!</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/w3f_logo.svg" alt="W3F Grants Program" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/w3f_logo.svg" alt="W3F Grants Program" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Grants Program</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/applications">List of Grants</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs/Process/how-to-apply">Apply</a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Implementation of the new hash function to BLS12 curves</h1></header>
<ul>
<li><strong>Team Name:</strong> Dmitrii Koshelev</li>
<li><strong>Payment Address:</strong> 0x050240CB2f5F7f7aA8AA10a5A9AE36c784AEdE49 (ERC20 USDC)</li>
<li><strong><a href="https://github.com/w3f/Grants-Program/tree/master#level_slider-levels" target="_blank" rel="noopener noreferrer">Level</a>:</strong> 2</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="project-overview-page_facing_up">Project Overview <!-- -->ðŸ“„<a href="#project-overview-page_facing_up" class="hash-link" aria-label="Direct link to project-overview-page_facing_up" title="Direct link to project-overview-page_facing_up">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">â€‹</a></h3>
<p>Please provide the following:</p>
<ul>
<li>If the name of your project is not descriptive, a tag line (one sentence summary).</li>
</ul>
<p>Implementation of my hash function in Sage in the general case and in Rust specifically for the curve BLS12-381.</p>
<ul>
<li>A brief description of your project.</li>
</ul>
<p>Recently, my article <a href="https://link.springer.com/article/10.1007/s10623-022-01012-8" target="_blank" rel="noopener noreferrer">https://link.springer.com/article/10.1007/s10623-022-01012-8</a> was published in the quite prestigious cryptographic journal &quot;Designs, Codes and Cryptography&quot;. This article provides a new hash function (indifferentiable from a random oracle) to the subgroup G1 of many elliptic curves of j-invariant 0, including most pairing-friendly curves of the family BLS12 (Barreto-Lynn-Scott) of embedding degree 12. Such curves and hash functions are actively used in blockchains, namely in the BLS (Boneh-Lynn-Shacham) aggregate signature. According to the web page <a href="https://wiki.polkadot.network/docs/learn-keys" target="_blank" rel="noopener noreferrer">https://wiki.polkadot.network/docs/learn-keys</a>, the BLS signature will be in particular used in Polkadot.</p>
<p>My hash function is much faster than previous state-of-the-art ones, including the Wahby-Boneh indirect map to the curve BLS12-381. This curve is a de facto standard in today&#x27;s real-world pairing-based cryptography. The indifferentiable Wahby-Boneh hash function requires to extract two square roots (i.e., to compute two exponentiations) in the basic field Fp. In comparison, the new hash function extracts only one cubic root, which can be also expressed via one exponentiation in Fp. And according to Section 1.1 of my other article <a href="https://eprint.iacr.org/2021/1082" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2021/1082</a> the exponentiations for square and cubic roots in Fp have short addition chains of about the same length.</p>
<p>I have already checked the correctness of my results in the computer algebra system Magma. The new project is dedicated to an implementation of the new hash function to BLS12-381 in Rust. This project is a follow-up of the previous one concerning a proof-of-concept implementation in Sage (see #825). I wrote such an implementation, but I didn&#x27;t finish the project, because my code does not meet high standards of Web3 Foundation. However, I found a professional developer in Rust who is ready to provide a Rust implementation (based on my Sage one), including tests. Consequently, besides my initial $10,000 reward (level 1), an additional reward for my colleague&#x27;s work is required.</p>
<ul>
<li>An indication of how your project relates to / integrates into Substrate / Polkadot / Kusama.</li>
</ul>
<p>According to the web page <a href="https://wiki.polkadot.network/docs/learn-keys" target="_blank" rel="noopener noreferrer">https://wiki.polkadot.network/docs/learn-keys</a>, the BLS signature will be in particular used in Polkadot.</p>
<ul>
<li>An indication of why your team is interested in creating this project.</li>
</ul>
<p>Because I want to demonstrate to the blockchain society that my research has an immediate practical value.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="project-details">Project Details<a href="#project-details" class="hash-link" aria-label="Direct link to Project Details" title="Direct link to Project Details">â€‹</a></h3>
<ul>
<li>PoC/MVP or other relevant prior work or research on the topic</li>
</ul>
<p>My article <a href="https://link.springer.com/article/10.1007/s10623-022-01012-8" target="_blank" rel="noopener noreferrer">https://link.springer.com/article/10.1007/s10623-022-01012-8</a> under the name &quot;Indifferentiable hashing to ordinary elliptic Fq-curves of j=0 with the cost of one exponentiation in Fq&quot;.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ecosystem-fit">Ecosystem Fit<a href="#ecosystem-fit" class="hash-link" aria-label="Direct link to Ecosystem Fit" title="Direct link to Ecosystem Fit">â€‹</a></h3>
<ul>
<li>Where and how does your project fit into the ecosystem?</li>
</ul>
<p>Hashing to elliptic curves in the BLS (Boneh-Lynn-Shacham) aggregate signature.</p>
<ul>
<li>Who is your target audience (parachain/dapp/wallet/UI developers, designers, your own user base, some dapp&#x27;s userbase, yourself)?</li>
</ul>
<p>Developers who will use the new hash function in their implementations of cryptographic protocols.</p>
<ul>
<li>Are there any other projects similar to yours in the Substrate / Polkadot / Kusama ecosystem?<!-- -->
<ul>
<li>If so, how is your project different?</li>
<li>If not, are there similar projects in related ecosystems?</li>
</ul>
</li>
</ul>
<p>I don&#x27;t know, because my project is quite extraordinary, in my opinion. Maybe, similar projects (based on recent results of mathematical cryptography) periodically arise in the Ethereum Foundation grants program.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="team-busts_in_silhouette">Team <!-- -->ðŸ‘¥<a href="#team-busts_in_silhouette" class="hash-link" aria-label="Direct link to team-busts_in_silhouette" title="Direct link to team-busts_in_silhouette">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="team-members">Team members<a href="#team-members" class="hash-link" aria-label="Direct link to Team members" title="Direct link to Team members">â€‹</a></h3>
<ul>
<li>Name of team leader</li>
</ul>
<p>Dmitrii Koshelev</p>
<ul>
<li>Names of team members</li>
</ul>
<p>My colleague who is a professional Rust programmer. He prefers to be anonymous.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contact">Contact<a href="#contact" class="hash-link" aria-label="Direct link to Contact" title="Direct link to Contact">â€‹</a></h3>
<ul>
<li><strong>Contact Name:</strong> Dmitrii Koshelev</li>
<li><strong>Contact Email:</strong> <a href="mailto:dimitri.koshelev@gmail.com" target="_blank" rel="noopener noreferrer">dimitri.koshelev@gmail.com</a></li>
<li><strong>Website:</strong> <a href="https://www.researchgate.net/profile/Dimitri-Koshelev" target="_blank" rel="noopener noreferrer">https://www.researchgate.net/profile/Dimitri-Koshelev</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="legal-structure">Legal Structure<a href="#legal-structure" class="hash-link" aria-label="Direct link to Legal Structure" title="Direct link to Legal Structure">â€‹</a></h3>
<ul>
<li><strong>Registered Address:</strong> 27B boulevard Jourdan, app. 317, Paris, France</li>
<li><strong>Registered Legal Entity:</strong> In this project I am an individual, but I work as a postdoctoral researcher in Telecom Paris (Polytechnic Institute of Paris).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="teams-experience">Team&#x27;s experience<a href="#teams-experience" class="hash-link" aria-label="Direct link to Team&#x27;s experience" title="Direct link to Team&#x27;s experience">â€‹</a></h3>
<p>There is the regularly updated CFRG draft on hashing to elliptic curves: <a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hash-to-curve/" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/draft-irtf-cfrg-hash-to-curve/</a>. As for me, at the beginning
of the last year, as said in <a href="https://blog.ethereum.org/2021/11/04/esp-allocation-update-q2-2021/" target="_blank" rel="noopener noreferrer">https://blog.ethereum.org/2021/11/04/esp-allocation-update-q2-2021/</a>, I won an Ethereum Foundation grant to derive a fast hash function to the subgroup G2 of the pairing-friendly curve BLS12-381. As an outcome of this grant, in Section 1.2 of <a href="https://eprint.iacr.org/2021/1082" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2021/1082</a> I prove that for hashing to G2 the Wahby-Boneh map applied only once (not twice) is sufficient to act as a random oracle. Thus we get rid of one exponentiation in the quadratic extension Fp2 or, equivalently, of two exponentiations in the prime field Fp. Besides, I constructed a series of hash functions to other elliptic curves in the articles <a href="https://eprint.iacr.org/2021/1034" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2021/1034</a> (accepted in SIAM Journal on Applied Algebra and Geometry), <a href="https://link.springer.com/article/10.1007/s12095-021-00478-y" target="_blank" rel="noopener noreferrer">https://link.springer.com/article/10.1007/s12095-021-00478-y</a> (published in Cryptography and Communications), <a href="https://eprint.iacr.org/2021/1604" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2021/1604</a> (submitted to Journal of Mathematical Cryptology).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="team-code-repos">Team Code Repos<a href="#team-code-repos" class="hash-link" aria-label="Direct link to Team Code Repos" title="Direct link to Team Code Repos">â€‹</a></h3>
<ul>
<li><a href="https://github.com/dishport" target="_blank" rel="noopener noreferrer">https://github.com/dishport</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="team-linkedin-profiles-if-available">Team LinkedIn Profiles (if available)<a href="#team-linkedin-profiles-if-available" class="hash-link" aria-label="Direct link to Team LinkedIn Profiles (if available)" title="Direct link to Team LinkedIn Profiles (if available)">â€‹</a></h3>
<ul>
<li><a href="https://www.linkedin.com/in/dimitri-koshelev/" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/in/dimitri-koshelev/</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-status-open_book">Development Status <!-- -->ðŸ“–<a href="#development-status-open_book" class="hash-link" aria-label="Direct link to development-status-open_book" title="Direct link to development-status-open_book">â€‹</a></h2>
<ul>
<li>links to your research diary, blog posts, articles, forum discussions or open GitHub issues,</li>
</ul>
<p><a href="https://ethresear.ch/t/indifferentiable-hashing-to-ordinary-elliptic-fq-curves-of-j-0-with-the-cost-of-one-exponentiation-in-fq/8867" target="_blank" rel="noopener noreferrer">https://ethresear.ch/t/indifferentiable-hashing-to-ordinary-elliptic-fq-curves-of-j-0-with-the-cost-of-one-exponentiation-in-fq/8867</a></p>
<p><a href="https://github.com/cfrg/draft-irtf-cfrg-hash-to-curve/issues/316" target="_blank" rel="noopener noreferrer">https://github.com/cfrg/draft-irtf-cfrg-hash-to-curve/issues/316</a></p>
<p><a href="https://github.com/dishport/Indifferentiable-hashing-to-ordinary-elliptic-curves-of-j-0-with-the-cost-of-one-exponentiation" target="_blank" rel="noopener noreferrer">https://github.com/dishport/Indifferentiable-hashing-to-ordinary-elliptic-curves-of-j-0-with-the-cost-of-one-exponentiation</a></p>
<p><a href="https://link.springer.com/article/10.1007/s10623-022-01012-8" target="_blank" rel="noopener noreferrer">https://link.springer.com/article/10.1007/s10623-022-01012-8</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-roadmap-nut_and_bolt">Development Roadmap <!-- -->ðŸ”©<a href="#development-roadmap-nut_and_bolt" class="hash-link" aria-label="Direct link to development-roadmap-nut_and_bolt" title="Direct link to development-roadmap-nut_and_bolt">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-1">Overview<a href="#overview-1" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">â€‹</a></h3>
<ul>
<li><strong>Total Estimated Duration:</strong> 6 months</li>
<li><strong>Full-Time Equivalent (FTE):</strong> 1 FTE</li>
<li><strong>Total Costs:</strong> 15,000 USD</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="milestone-1--an-implementation-in-sage">Milestone 1 â€” An implementation in Sage<a href="#milestone-1--an-implementation-in-sage" class="hash-link" aria-label="Direct link to Milestone 1 â€” An implementation in Sage" title="Direct link to Milestone 1 â€” An implementation in Sage">â€‹</a></h3>
<ul>
<li><strong>Estimated duration:</strong> 3 months</li>
<li><strong>FTE:</strong>  1</li>
<li><strong>Costs:</strong> 10,000 USD</li>
</ul>
<table><thead><tr><th style="text-align:right">Number</th><th>Deliverable</th><th>Specification</th></tr></thead><tbody><tr><td style="text-align:right">0a.</td><td>License</td><td>GNU GPL</td></tr><tr><td style="text-align:right">0b.</td><td>Documentation</td><td>I will provide <strong>inline documentation</strong> of the code.</td></tr><tr><td style="text-align:right">0c.</td><td>Testing Guide</td><td></td></tr><tr><td style="text-align:right">0d.</td><td>Docker</td><td>I do not intend to deliver this, because the project is research oriented.</td></tr><tr><td style="text-align:right">0e.</td><td>Article</td><td>I will cite the implementation and I will thank Web3 Foundation for its financial support in my new article <a href="https://eprint.iacr.org/2021/1082" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2021/1082</a>. I submitted this article to Journal of Cryptology. At the moment, it is under review.</td></tr><tr><td style="text-align:right">1.</td><td>Implementation</td><td>Sage (non-constant-time) implementation of the hash function described below.</td></tr></tbody></table>
<p>To be definite, let me use the notation of my article <a href="https://link.springer.com/article/10.1007/s10623-022-01012-8" target="_blank" rel="noopener noreferrer">https://link.springer.com/article/10.1007/s10623-022-01012-8</a>. The new hash function consists of three components: a classical one \eta: <!-- -->1<!-- -->^* -&gt; Fp^2, a rational map \varphi: Fp^2 -&gt; T(Fp), and an additional map h^\prime: T(Fp) -&gt; E(Fp), where E is a given elliptic Fp-curve of j-invariant 0 and T is a suplementary algebraic threefold. A construction of \eta is represented in Section 5 of the draft <a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hash-to-curve/" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/draft-irtf-cfrg-hash-to-curve/</a>. This is the composition of a hash function <!-- -->1<!-- -->^* -&gt; <!-- -->1<!-- -->^n for some n \in N and the subsequent restriction modulo p, hence we can use a standard hash function from one of cryptographic libraries. It remains to implement \varphi and h^\prime just as described in my article.</p>
<p>It is also worth noting that the new hash function is relevant for any ordinary (i.e., non-supersingular) elliptic Fq-curve y^2 = x^3 + b (of j-invariant 0) such that the square root of b lies in Fq. Here Fq is an arbitrary finite field (of characteristic p &gt; 3) for which 3 divides q-1, but 27 does not. Therefore, our Sage implementation is in fact relevant for all such curves and fields. The BLS12-381 curve corresponds to the case when q = 10 (mod 27) and b is not a cubic residue in Fq.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="milestone-2--a-non-constant-time-implementation-in-rust-in-the-case-of-the-bls12-381-curve">Milestone 2 â€” A non-constant-time implementation in Rust in the case of the BLS12-381 curve<a href="#milestone-2--a-non-constant-time-implementation-in-rust-in-the-case-of-the-bls12-381-curve" class="hash-link" aria-label="Direct link to Milestone 2 â€” A non-constant-time implementation in Rust in the case of the BLS12-381 curve" title="Direct link to Milestone 2 â€” A non-constant-time implementation in Rust in the case of the BLS12-381 curve">â€‹</a></h3>
<ul>
<li><strong>Estimated duration:</strong> 3 months</li>
<li><strong>FTE:</strong>  1</li>
<li><strong>Costs:</strong> 5,000 USD</li>
</ul>
<table><thead><tr><th style="text-align:right">Number</th><th>Deliverable</th><th>Specification</th></tr></thead><tbody><tr><td style="text-align:right">0a.</td><td>License</td><td>Apache License, Version 2.0 and MIT license</td></tr><tr><td style="text-align:right">0b.</td><td>Documentation</td><td>I will provide <strong>inline documentation</strong> of the code.</td></tr><tr><td style="text-align:right">0c.</td><td>Testing Guide</td><td>Core functions will be fully covered by unit tests to ensure functionality and robustness. I will describe how to run these tests.</td></tr><tr><td style="text-align:right">0d.</td><td>Docker</td><td>I do not intend to deliver this, because the project is research oriented.</td></tr><tr><td style="text-align:right">0e.</td><td>Article</td><td>I will cite the implementation and I will thank Web3 Foundation for its financial support in my new article <a href="https://eprint.iacr.org/2021/1082" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2021/1082</a>. I submitted this article to Journal of Cryptology. At the moment, it is under review.</td></tr><tr><td style="text-align:right">1.</td><td>Implementation</td><td>Rust non-constant-time implementation of the new hash function for BLS12-381. It is suggested to use the library arkworks (<a href="https://github.com/arkworks-rs/curves" target="_blank" rel="noopener noreferrer">https://github.com/arkworks-rs/curves</a>) as a base. In particular, to perform the (unique) exponentiation in Fp an addition chain of quite small length has already been derived in <a href="https://github.com/dishport/Some-remarks-on-how-to-hash-faster-onto-elliptic-curves" target="_blank" rel="noopener noreferrer">https://github.com/dishport/Some-remarks-on-how-to-hash-faster-onto-elliptic-curves</a> (cf. Section 1.1 of <a href="https://eprint.iacr.org/2021/1082" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2021/1082</a>).</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="future-plans">Future Plans<a href="#future-plans" class="hash-link" aria-label="Direct link to Future Plans" title="Direct link to Future Plans">â€‹</a></h2>
<p>The new hash function appears to be optimal, because it performs only one exponentiation in the basic field Fq. In other words, since it is highly unlikely that there is a hash function to an elliptic curve without exponentiations at all (even if it is supersingular), the result of my article seems to be unimprovable. Thus I hope that the implementation of my hash function will be interesting not only to you, but also to all blockchain projects that involve the BLS signature.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-information-heavy_plus_sign">Additional Information <!-- -->âž•<a href="#additional-information-heavy_plus_sign" class="hash-link" aria-label="Direct link to additional-information-heavy_plus_sign" title="Direct link to additional-information-heavy_plus_sign">â€‹</a></h2>
<p><strong>How did you hear about the Grants Program?</strong> Web3 Foundation Website</p>
<ul>
<li>If there are any other teams who have already contributed (financially) to the project.</li>
</ul>
<p>No</p>
<ul>
<li>Previous grants you may have applied for.</li>
</ul>
<p>An Ethereum Foundation grant called &quot;fast hash-to-curve research&quot; and represented on the web page <a href="https://blog.ethereum.org/2021/11/04/esp-allocation-update-q2-2021/" target="_blank" rel="noopener noreferrer">https://blog.ethereum.org/2021/11/04/esp-allocation-update-q2-2021/</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/w3f/Grants-Program/edit/master/applications/new_bls12_hash_function.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#project-overview-page_facing_up" class="table-of-contents__link toc-highlight">Project Overview ðŸ“„</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#project-details" class="table-of-contents__link toc-highlight">Project Details</a></li><li><a href="#ecosystem-fit" class="table-of-contents__link toc-highlight">Ecosystem Fit</a></li></ul></li><li><a href="#team-busts_in_silhouette" class="table-of-contents__link toc-highlight">Team ðŸ‘¥</a><ul><li><a href="#team-members" class="table-of-contents__link toc-highlight">Team members</a></li><li><a href="#contact" class="table-of-contents__link toc-highlight">Contact</a></li><li><a href="#legal-structure" class="table-of-contents__link toc-highlight">Legal Structure</a></li><li><a href="#teams-experience" class="table-of-contents__link toc-highlight">Team&#39;s experience</a></li><li><a href="#team-code-repos" class="table-of-contents__link toc-highlight">Team Code Repos</a></li><li><a href="#team-linkedin-profiles-if-available" class="table-of-contents__link toc-highlight">Team LinkedIn Profiles (if available)</a></li></ul></li><li><a href="#development-status-open_book" class="table-of-contents__link toc-highlight">Development Status ðŸ“–</a></li><li><a href="#development-roadmap-nut_and_bolt" class="table-of-contents__link toc-highlight">Development Roadmap ðŸ”©</a><ul><li><a href="#overview-1" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#milestone-1--an-implementation-in-sage" class="table-of-contents__link toc-highlight">Milestone 1 â€” An implementation in Sage</a></li><li><a href="#milestone-2--a-non-constant-time-implementation-in-rust-in-the-case-of-the-bls12-381-curve" class="table-of-contents__link toc-highlight">Milestone 2 â€” A non-constant-time implementation in Rust in the case of the BLS12-381 curve</a></li></ul></li><li><a href="#future-plans" class="table-of-contents__link toc-highlight">Future Plans</a></li><li><a href="#additional-information-heavy_plus_sign" class="table-of-contents__link toc-highlight">Additional Information âž•</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More Info</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/w3f/Grants-Program" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://web3.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/Support Docs/privacy_policy">Privacy Policy</a></li><li class="footer__item"><a href="https://web3.foundation/legal-disclosures/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Legal Disclosures</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/Web3foundation" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://matrix.to/#/!XpynPDLusWUWfDpaqr:matrix.org?via=web3.foundation&amp;via=matrix.org&amp;via=matrix.parity.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Grants Community Matrix Channel<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2025 Web3 Foundation</div></div></div></footer></div>
</body>
</html>