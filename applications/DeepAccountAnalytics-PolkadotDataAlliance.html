<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-applications/DeepAccountAnalytics-PolkadotDataAlliance">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Web3 Foundation Deep Account Analytics in Three Tiers for the Polkadot Data Alliance | Web3 Foundation Grants</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://grants.web3.foundation/applications/DeepAccountAnalytics-PolkadotDataAlliance"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Web3 Foundation Deep Account Analytics in Three Tiers for the Polkadot Data Alliance | Web3 Foundation Grants"><meta data-rh="true" name="description" content="- Team Name: Colorful Notion, Inc."><meta data-rh="true" property="og:description" content="- Team Name: Colorful Notion, Inc."><link data-rh="true" rel="icon" href="/img/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://grants.web3.foundation/applications/DeepAccountAnalytics-PolkadotDataAlliance"><link data-rh="true" rel="alternate" href="https://grants.web3.foundation/applications/DeepAccountAnalytics-PolkadotDataAlliance" hreflang="en"><link data-rh="true" rel="alternate" href="https://grants.web3.foundation/applications/DeepAccountAnalytics-PolkadotDataAlliance" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9VKKGZO0U1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Web3 Foundation Grants" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.4bc56efa.css">
<link rel="preload" href="/assets/js/runtime~main.3bea6f0c.js" as="script">
<link rel="preload" href="/assets/js/main.61fc85c3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#000;color:#ffffff" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Check out our <a target="_blank" rel="noopener noreferrer" href="https://medium.com/web3foundation/web3-foundation-grants-program-reaches-500-projects-milestone-bf314727b2f9">500 GRANTS blogpost</a>!</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/w3f_logo.svg" alt="W3F Grants Program" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/w3f_logo.svg" alt="W3F Grants Program" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Grants Program</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/introduction">Introduction</a><a class="navbar__item navbar__link" href="/applications">List of Grants</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs/Process/how-to-apply">Apply</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Web3 Foundation Deep Account Analytics in Three Tiers for the Polkadot Data Alliance</h1><ul><li><strong>Team Name:</strong> Colorful Notion, Inc.</li><li><strong>Payment Address</strong> <code>0xEaf3223589Ed19bcd171875AC1D0F99D31A5969c</code></li><li><strong><a href="https://github.com/w3f/Grants-Program/tree/master#level_slider-levels" target="_blank" rel="noopener noreferrer">Level</a>:</strong> 2</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="abstract-">Abstract ðŸ“„<a href="#abstract-" class="hash-link" aria-label="Direct link to Abstract ðŸ“„" title="Direct link to Abstract ðŸ“„">â€‹</a></h2><p>This proposal addresses outstanding <a href="https://github.com/w3f/Grants-Program/blob/master/docs/RFPs/Open/data_analysis_tools.md" target="_blank" rel="noopener noreferrer">deep account analytics problems for the Web3 Foundation</a>.
We propse 3-tier solution:</p><ul><li>Tier 1. <em>raw indexing</em>: Google BigQuery Public Datasets</li><li>Tier 2. <em>deep indexing</em>: shared datasets delivered with Google Analytics Hub</li><li>Tier 3. <em>dashboards</em>: the above indexed data in Apache Superset</li></ul><p>This proposal seeks to develop the above solution with the support of a Web3 Foundation grant, but critically addresses
future maintainance a <a href="https://docs.google.com/document/d/1fA5ARHy-frzgZC66rniKZ5o7CSbDvCTkS--kWaMzuMs/edit#" target="_blank" rel="noopener noreferrer">Polkadot Data Alliance Bounty</a>
that can support work on all 3 tiers with <em>child bounties</em> for Polkadot Data Alliance contributors.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="project-overview-">Project Overview ðŸ“„<a href="#project-overview-" class="hash-link" aria-label="Direct link to Project Overview ðŸ“„" title="Direct link to Project Overview ðŸ“„">â€‹</a></h2><p>This proposal is in response to the RFP <a href="https://github.com/w3f/Grants-Program/blob/master/docs/RFPs/Open/data_analysis_tools.md" target="_blank" rel="noopener noreferrer">Data Analysis Tools for Substrate-based Blockchains</a>
which seeks to answer deep account analytics questions of:</p><p><strong>Account References</strong>:</p><ul><li>Which transactions/accounts were responsible for the reserved balance in an account?</li><li>What modules currently depend on consumers, providers, and sufficients reference counters for a certain account, and which transactions introduced/removed those references?</li><li>What are the pallets responsible for reserves/holds and locks/freezes on an account?</li></ul><p><strong>Democracy</strong>:</p><ul><li>Which accounts have delegated OpenGov votes to an account or to which accounts the account in question has delegated their votes to for each track?</li></ul><p><strong>Staking/Nomination Pools</strong>:</p><ul><li>Who are all the nominators that nominated Validator X? (an inverse mapping basically of staking.nominators from validator -&gt; nominators)</li><li>Who are the top 10 nominators with the highest APR, and which validators do they have in common?</li></ul><p>We call these <em>deep analytics</em> questions because to answer them requires significant &quot;deep indexing&quot; beyond &quot;raw indexing&quot;, which cannot be done without intricate knowledge of Substrate.  Currently, these questions are difficult to answer without going through many pages in a block explorer like Polkaholic.io, and nearly impossible without doing some amount of data engineering.  The answers to the above questions <em>could</em> be treated as new features to be developed in the context of block explorer like Polkaholic, or within special purpose UIs like polkassembly or staking.polkadot.network.</p><p>We propose a different style of solution that we believe properly factorizes the following <em>three</em> tiers:</p><ul><li>Tier 1. raw indexing - raw indexing of decoded blocks (blocks, extrinsics/calls, events, traces)</li><li>Tier 2. deep indexing - post-processing of raw indexed data </li><li>Tier 3. dashboards - situating the above with BI tools -- speci that does not require deep knowledge of the structure of the indexed data</li></ul><p>Typically, a block explorer or special purpose UI concerning chain
data blends all of these three tiers together -- and the maintainer of
the block explorer enjoys a community following (etherscan.io ).  But
often when new deep analytics questions arise are not directly
available in an explorer, users with deep account analytics questions
are left struggling and need custom answers only provided by data
engineers and analytics engines -- covered by dashboard systems like
Dune Analytics.  In Dune Analytics, Tier 2 is covered by Dune Wizards
and Tier 3 is covered with a customized front-end.  </p><p>The solution we develop here is <em>not</em> to make a long list of feature
requests for either block explorers or special purpose UIs to answer
with new functionality.</p><p>Instead, our solution to this problem is to separate the THREE TIERS within a <em>genuinely collaborative</em> Polkadot Data Alliance:</p><ul><li><p>Tier 1: raw indexing results in all blocks, extrinsics, events, traces delivered in Google Bigquery Public Datasets.  In May 2023, Colorful Notion, under the curation of Parity Data, onboarded a complete index of 70+ chains of Polkadot+Kusama into Google Public Datasets.  This is in the &quot;crypto_polkadot&quot; and &quot;crypto_kusama&quot; dataset, which anyone can access with this Analytics Hub link <a href="https://console.cloud.google.com/bigquery/analytics-hub/exchanges/projects/974572213039/locations/us/dataExchanges/substrate_18804f88005/listings/polkadot_188057df28c?project=github-integration-295917" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://console.cloud.google.com/bigquery/analytics-hub/exchanges/projects/974572213039/locations/us/dataExchanges/substrate_18804f88005/listings/kusama_1880581b627?project=github-integration-295917" target="_blank" rel="noopener noreferrer">here</a>.</p></li><li><p>Tier 2: deep indexing can then be done by doing some amount of data engineering with the above raw deata, resulting in tables, views or materialized views that can also be shared with new datasets, which can also be shared with Analytics Hub.</p></li><li><p>Tier 3: front-end engineering: given the above dataset, an open source BI tool (Apache Superset) can access <em>multiple</em> datasets contributed by <em>multiple</em> Polkadot Data Alliance members.  Recently, Parity Data shared this dataset of <em>their</em> index of Polkadot, which enables a simple comparison between Parity Data&#x27;s index and Colorful Notions&#x27; index.</p></li></ul><p>We consider our approach a <em>genuinely collaborative</em> approach, because anyone can contribute at any of the 3 tiers -- providing raw indexes, deep indexes, or dashboards.  All dataset deliverables are public and the data processing itself is also reproducible in a &quot;ETL&quot; flow.  This should be contrast to a <em>non-collaborative</em> approach where dataset is kept locked away unshared with the community, closed source and thus irreproducible.</p><p>However, because all three tiers involve a certain amount of storage, compute and data engineering/data analyst man power, it is critical to not <em>just</em> build the above three tiered solution,
but recognize that it needs <strong>maintainence</strong>.  The Web3 Foundation supports maintainence, but does not support the considerable cloud computing costs that Tier 1 and 2 require, nor the sort of solution that Tier 3 requires.  We thus propose that the above three tier architecture be situated <em>in conjunction with</em> a <a href="https://docs.google.com/document/d/1fA5ARHy-frzgZC66rniKZ5o7CSbDvCTkS--kWaMzuMs/edit#" target="_blank" rel="noopener noreferrer">Polkadot Data Alliance bounty</a>, not just for ourselves at Colorful Notion, but for everyone equally commited to genuine collaboration a Polkadot Data Alliance.  </p><p>It is believed that this collaborative framework can address many different problems other than deep analytics, and result in a more efficient allocation of Treasury funds and parachain resources: including an industry-wide multichain block explorer, ecosystem-wide XCM indexing, tracing tools, to name a few that our team has explored with some depth of seriousness.</p><p>Much Tier 1 foundation has already been laid through our work and other indexers (Subquery, Subsquid, Subscan, web3go) in the ecosystem, who we hope will be able to contribute at Tier 1 <!-- -->[ideally within BigQuery so as to be directly usable as another source for Tier 2 and Tier 3]<!-- -->.</p><p>But Tier 1 is not enough -- it is necessary to address Tier 2 and Tier 3 as well, and the Web3 Foundation RFP questions clearly illustrate the inadequacy of stopping with raw indexes and the need for deep indexing.  We believe a strong collaborative mindset is required to fully address these questions and numerous others the Substrate ecosystem asks comprehensively.</p><p>The goal of this proposal is to:</p><ul><li>address the Web3 Foundation&#x27;s specific deep account analytics questions fully, specifically with three-tiered deliverables at Tier 1+2+3, using widely used tools of Google BigQuery and Apache Superset</li><li>demonstrate a viable financial path for our own maintainence for the above solution within the Web3 Foundation grant structure and the structure of the Polkadot Treasury using the Polkadot Data Bounty system</li><li>form an alternate kind of deliverable for Web3 Foundation other than code that everyone can use: <em>datasets</em> and <em>dashboards</em> that everyone can use</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="project-details">Project Details<a href="#project-details" class="hash-link" aria-label="Direct link to Project Details" title="Direct link to Project Details">â€‹</a></h3><p>The &quot;Account References&quot; questions of</p><ul><li>Which transactions/accounts were responsible for the reserved balance in an account?</li><li>What modules currently depend on consumers, providers, and sufficients reference counters for a certain account, and which transactions introduced/removed those references?</li><li>What are the pallets responsible for reserves/holds and locks/freezes on an account?</li></ul><p>are largely answerable through traces.  At the heart of every
blockchain is a state transition function, where the state transitions
for any block are commonly called &quot;traces&quot; in blockchain engineering.
Substrate makes every trace visible through a
<a href="https://polkadot.js.org/docs/substrate/rpc/#traceblockblock-hash-targets-optiontext-storagekeys-optiontext-methods-optiontext-traceblockresponse" target="_blank" rel="noopener noreferrer">state_traceBlock</a>
RPC function, which outputs every storage key-value map change in a
re-execution of a single block.  This RPC call is considered &quot;unsafe&quot;
as it requires compute time to regenerate.</p><p>Polkaholic.io&#x27;s indexer, when traces are available from an internal archive node, fetches traces and exposes them in the block explorer.
For example, here is the trace for <a href="https://polkaholic.io/trace/polkadot/15723663/" target="_blank" rel="noopener noreferrer">Polkadot Block 15723663</a></p><img loading="lazy" src="https://cdn.polkaholic.io/screenshots/polkadot-trace.png" class="img_ev3q"><p>The raw keys (e.g. <code>0x26aa394eea5630e0...f1dbd372bbe532b1f8702b2a7e</code>) and values (e.g. <code>0x01ab50050...000000000000</code>) are decoded using the chains type spec into </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Key: [ &quot;12xtAYsRUrmbniiWQqJtECiBQrMn8AypQcXhnQAc6RB6XkLW&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Value: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;nonce&quot;: 348331,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;consumers&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;providers&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;sufficients&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;data&quot;: âŠ–{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;free&quot;: &quot;0x000000000000000005785a9c9f9ad21b&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;reserved&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;miscFrozen&quot;: &quot;0x00000000000000000058d15e17628000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;feeFrozen&quot;: &quot;0x00000000000000000058d15e17628000&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and loaded into BigQuery as part of a publicly available <a href="https://console.cloud.google.com/bigquery/analytics-hub/exchanges/projects/974572213039/locations/us/dataExchanges/substrate_18804f88005" target="_blank" rel="noopener noreferrer">substrate-etl</a>, recently added to Google BigQuery&#x27;s Public Datasets in May 2023.</p><img loading="lazy" src="https://cdn.polkaholic.io/screenshots/substrate-etl-trace.png" class="img_ev3q"><p>In Milestone 1, we will provide a 3 tier solution to deep account analytics on Account References.  Here is how the 3 tiers:</p><ul><li><p>Tier 1 requires <em>raw indexing</em> of traces.  Traces are critical to Colorful Notion&#x27;s <a href="https://polkaholic.io/xcmtransfers?xcmType=xcmtransfer" target="_blank" rel="noopener noreferrer">XCM Indexing</a> and are important for parachain engineers to understand how the execution of a block, and are critical to the model producers, consumers and sufficients.   As raw traces form a very large dataset, to keep storage costs low, the indexer filters out pallets section/method that and exposes them in <code>crypto_polkadot.traces0</code> (<a href="https://github.com/colorfulnotion/polkaholic/blob/main/substrate/schema/substrateetl/traces.json" target="_blank" rel="noopener noreferrer">see schema</a>).  In particular, given how central accounts and native and non-native tokens are to blockchain usage, the indexer further decodes accounts and asset state into many additional columns like free, reserved and frozen.  </p></li><li><p>Tier 2 requires <em>deep indexing</em> of the above trace data, to analyze how certain attributes changed in <a href="https://docs.google.com/spreadsheets/d/1jywN--pONmJqmbuASWDLNdBvsB86OuizJnQ72ijAXSU/edit#gid=704412439" target="_blank" rel="noopener noreferrer">System:Account</a> holding account reference counters, account balance reserved provenance (see: <a href="https://docs.substrate.io/reference/account-data-structures/" target="_blank" rel="noopener noreferrer">https://docs.substrate.io/reference/account-data-structures/</a>).  We have some preliminary work on this (see <a href="https://docs.google.com/spreadsheets/d/1gZZOvH4BYk2QYlhzz9AvRxiR6mcYtgRz9VZluz1lwuU/edit#gid=1313769699" target="_blank" rel="noopener noreferrer">this sheet</a>) and proved that, yes, it is indeed possible to uniquely identify the extrinsic id (but not call id) for every trace, and that the changes can be identified to build a new dataset every day.</p></li><li><p>Tier 3 requires situating the above dataset into an Account Analysis Dashboard of <a href="https://analytics.polkaholic.io/dashboard/list/" target="_blank" rel="noopener noreferrer">Apache Superset</a>.   Here we have a WASM Contract Explorer prototype:</p></li></ul><img loading="lazy" src="https://cdn.polkaholic.io/screenshots/deep-account-dashboard.png" class="img_ev3q"><p>We envision Milestone 1 focussed on Account References and then extended in Milestone 2 to Democracy+Staking deep analysis.  This will result in an Account Analysis Dashboard, with 3 or more account tabs exploring:</p><ul><li><p>&quot;Account References&quot; concerning deep indexing developed in Milestone 1</p></li><li><p>&quot;Democracy&quot; concerning deep indexing about <a href="https://docs.google.com/spreadsheets/d/1hdvW5Kw3gwBnXqFskALX1_szdTf4pYL-SlbOqJ8tlO0/edit#gid=1803912396" target="_blank" rel="noopener noreferrer">Democracy:VotingOf</a> developed in Milestone 2</p></li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;direct&quot;:{&quot;delegations&quot;:{&quot;capital&quot;:0,&quot;votes&quot;:0},&quot;prior&quot;:[0,0],&quot;votes&quot;:[[113,{&quot;standard&quot;:{&quot;vote&quot;:&quot;0x81&quot;,&quot;balance&quot;:10000000000}}],[119,{&quot;standard&quot;:{&quot;vote&quot;:&quot;0x82&quot;,&quot;balance&quot;:50000000000}}]]}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>OR</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;delegating&quot;:{&quot;balance&quot;:15000000000,&quot;conviction&quot;:&quot;Locked4x&quot;,&quot;delegations&quot;:{&quot;capital&quot;:0,&quot;votes&quot;:0},&quot;prior&quot;:[0,0],&quot;target&quot;:&quot;15ZvLonEseaWZNy8LDkXXj3Y8bmAjxCjwvpy4pXWSL4nGSBs&quot;}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>&quot;Staking&quot; concerning deep indexing about Staking and Nomination Pools, with the added complexity of stashing controller/accounts, developed in Milestone 2.</li></ul><p>It is straightforward to link these dashboards directly to polkaholic.io based the key (accountID/extrinsicID/...) and add filtering on any column present in the table with Apache Superset.</p><p>Any UI can then link to this dashboard with the account ID, and the dashboard can link back to a block explorer.</p><p>Once the dataset is made available, end users can build charts and dashboards with the same ease as they do in Excel or Google Sheets.</p><p>The community dashboard can be used in the same way as Dune Analytics dashboards serves the EVM community.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ecosystem-fit">Ecosystem Fit<a href="#ecosystem-fit" class="hash-link" aria-label="Direct link to Ecosystem Fit" title="Direct link to Ecosystem Fit">â€‹</a></h3><p>While this proposal does not explicitly require collaboration on any of the 3 tiers, our intention is to:</p><ol><li>set up a foundation where the Web3 Foundation could ask other teams to contribute datasets (Tier 2) and build dashboards (Tier 3) in the same way.</li><li>set up a repeatable model between Web3 Foundation and a Polkadot Data Alliance support data-oriented research (W3F) and ongoing maintenance (<a href="https://docs.google.com/document/d/1fA5ARHy-frzgZC66rniKZ5o7CSbDvCTkS--kWaMzuMs/edit#" target="_blank" rel="noopener noreferrer">Polkadot Data Bounty</a>) with child bounties </li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="team-">Team ðŸ‘¥<a href="#team-" class="hash-link" aria-label="Direct link to Team ðŸ‘¥" title="Direct link to Team ðŸ‘¥">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="team-members--contact">Team members / Contact<a href="#team-members--contact" class="hash-link" aria-label="Direct link to Team members / Contact" title="Direct link to Team members / Contact">â€‹</a></h3><ul><li><strong>Contact Name:</strong> Sourabh Niyogi / Michael Chung</li><li><strong>Contact Email:</strong> <a href="mailto:sourabh@colorfulnotion.com" target="_blank" rel="noopener noreferrer">sourabh@colorfulnotion.com</a> / <a href="mailto:michael@colorfulnotion.com" target="_blank" rel="noopener noreferrer">michael@colorfulnotion.com</a></li><li><strong>Website:</strong> <a href="https://colorfulnotion.com" target="_blank" rel="noopener noreferrer">https://colorfulnotion.com</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="legal-structure">Legal Structure<a href="#legal-structure" class="hash-link" aria-label="Direct link to Legal Structure" title="Direct link to Legal Structure">â€‹</a></h3><ul><li><strong>Registered Address:</strong> 55 E 3rd Ave, San Mateo, CA 94401, USA</li><li><strong>Registered Legal Entity:</strong> Colorful Notion, Inc.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="teams-experience">Team&#x27;s experience<a href="#teams-experience" class="hash-link" aria-label="Direct link to Team&#x27;s experience" title="Direct link to Team&#x27;s experience">â€‹</a></h3><ul><li><p>Key engineers Sourabh Niyogi and Michael Chung have developed Polkaholic.io since Fall 2021 and substrate-etl since December 2022.</p></li><li><p>Prior to building Polkaholic.io, Sourabh and Michael worked in decentralized social networking protocol development + privacy-preserving contact tracing (Wolk),
mobile advertising real-time bidding algorithm design and analytics (CrossChannel/MdotM).</p></li><li><p>Sourabh spent time doing computational cognitive science and machine vision research at MIT, including
in <!-- -->[Bayesian learning of verb meaning and causal laws]<!-- -->(<a href="https://scholar.google.com/citations?user=HHmGYdEAAAAJ&amp;hl=en%5D" target="_blank" rel="noopener noreferrer">https://scholar.google.com/citations?user=HHmGYdEAAAAJ&amp;hl=en]</a>.</p></li><li><p>Michael hails from UC Berkeley with a degree in statistics and economics and leads deep indexing at Colorful Notion.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="team-code-repos">Team Code Repos<a href="#team-code-repos" class="hash-link" aria-label="Direct link to Team Code Repos" title="Direct link to Team Code Repos">â€‹</a></h3><ul><li><a href="https://github.com/colorfulnotion/substrate-etl" target="_blank" rel="noopener noreferrer">substrate-etl</a></li><li><a href="https://github.com/colorfulnotion/polkaholic" target="_blank" rel="noopener noreferrer">Polkaholic.io</a></li><li><a href="https://github.com/colorfulnotion/xcm-global-registry" target="_blank" rel="noopener noreferrer">XCM Global Asset Registry</a></li><li><a href="https://github.com/sourabhniyogi" target="_blank" rel="noopener noreferrer">Sourabh Niyogi</a> | <a href="https://github.com/mkchungs" target="_blank" rel="noopener noreferrer">Michael Chung</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-status-">Development Status ðŸ“–<a href="#development-status-" class="hash-link" aria-label="Direct link to Development Status ðŸ“–" title="Direct link to Development Status ðŸ“–">â€‹</a></h2><ul><li>Summer 2022: Released Polkaholic.io, a fully working Substrate-first multichain block explorer.</li><li>Fall 2022: Increased XCM Transfers Coverage, Improved UI + API based on feedback from users.  Added EVM/WASM support.</li><li>Winter/Spring 2023: Developed substrate-etl and XCM Global Asset Registry.</li><li>May 2023: Google included Polkadot + Kusama in <a href="https://cloud.google.com/bigquery/public-data" target="_blank" rel="noopener noreferrer">Google Public Datasets</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-roadmap-">Development Roadmap ðŸ”©<a href="#development-roadmap-" class="hash-link" aria-label="Direct link to Development Roadmap ðŸ”©" title="Direct link to Development Roadmap ðŸ”©">â€‹</a></h2><p>This proposal aims to deliver on the three-tier architecture outlined in two milestones:</p><ul><li>Milestone 1 will develop <code>System:Account</code> deep analytics.</li><li>Milestone 2 will develop <code>Democracy</code>, <code>Staking</code> and <code>NominationPools</code> deep analytics.</li></ul><p>For each Milestone, there are 3 kinds of deliverables corresponding to the 3 tiers:</p><ul><li><ol><li>Raw indexes, in the form of BigQuery datasets which are delivered </li></ol></li><li><ol start="2"><li>Deep indexes, in the form of BigQuery dataset</li></ol></li><li><ol start="3"><li>Dashboard publication, in the form of Apache Superset Dashboard</li></ol></li></ul><p>All raw and deep indexing code will be made open source within the polkaholic and substrate-etl repo.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">â€‹</a></h3><ul><li><strong>Total Estimated Duration:</strong> 4 months</li><li><strong>Full-Time Equivalent (FTE):</strong>  300 FTE hours <!-- -->[100 USD/hr]</li><li><strong>Total Costs:</strong> 30,000 USD</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="milestone-1--three-tier-deep-account-analytics-on-account-references">Milestone 1 â€” Three Tier Deep Account Analytics on Account References<a href="#milestone-1--three-tier-deep-account-analytics-on-account-references" class="hash-link" aria-label="Direct link to Milestone 1 â€” Three Tier Deep Account Analytics on Account References" title="Direct link to Milestone 1 â€” Three Tier Deep Account Analytics on Account References">â€‹</a></h3><ul><li><strong>Estimated duration:</strong> 8 weeks (ending 8/31/23) </li><li><strong>FTE:</strong>  150 FTE hours <!-- -->[100 USD/hr]</li><li><strong>Costs:</strong> 15,000 USD</li></ul><table><thead><tr><th align="right">Number</th><th>Deliverable</th><th>Specification</th></tr></thead><tbody><tr><td align="right">0a.</td><td>License</td><td>GNUv3 - polkaholic + substrate-etl repo</td></tr><tr><td align="right">0b.</td><td>Documentation</td><td>Provide README on construction of 1+2+3</td></tr><tr><td align="right">0c.</td><td>Manual Testing Guide</td><td>Manual testing guide with steps for using the application, with examples including expected inputs and outputs</td></tr><tr><td align="right">1.</td><td>Raw Indexing</td><td>substrate-etl:crypto_polkadot.traces0 for 7/1/23 - 8/31/23</td></tr><tr><td align="right">2.</td><td>Deep Indexing</td><td>substrate-etl:substrate.accountreference0 and supporting datasets</td></tr><tr><td align="right">3.</td><td>Dashboard Publication</td><td>Superset dashboard tab: &quot;Account Reference&quot;</td></tr></tbody></table><p>We will take this opportunity to deliver raw indexes on traces, deep indexes on account references and a dashboard on Account References hosted at <a href="https://analytics.polkaholic.io" target="_blank" rel="noopener noreferrer">https://analytics.polkaholic.io</a>.</p><p>Indexing + Dashboard Publication must be able to support deep analysis of <strong>Account References</strong>:</p><ul><li>Which transactions/accounts were responsible for the reserved balance in an account?</li><li>What modules currently depend on consumers, providers, and sufficients reference counters for a certain account, and which transactions introduced/removed those references?</li><li>What are the pallets responsible for reserves/holds and locks/freezes on an account?</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="milestone-2--three-tier-deep-account-analysis-of-democracystakingnomination-pools">Milestone 2 â€” Three Tier Deep Account Analysis of Democracy+Staking+Nomination Pools<a href="#milestone-2--three-tier-deep-account-analysis-of-democracystakingnomination-pools" class="hash-link" aria-label="Direct link to Milestone 2 â€” Three Tier Deep Account Analysis of Democracy+Staking+Nomination Pools" title="Direct link to Milestone 2 â€” Three Tier Deep Account Analysis of Democracy+Staking+Nomination Pools">â€‹</a></h3><ul><li><strong>Estimated duration:</strong> 8 weeks (ending 10/31/23)</li><li><strong>FTE:</strong>  150 FTE hours <!-- -->[100 USD/hr]</li><li><strong>Costs:</strong> 15,000 USD</li></ul><table><thead><tr><th align="right">Number</th><th>Deliverable</th><th>Specification</th></tr></thead><tbody><tr><td align="right">0a.</td><td>License</td><td>GNUv3 - polkaholic + substrate-etl repo</td></tr><tr><td align="right">0b.</td><td>Documentation</td><td>Document substrate-etl README on 1+2+3</td></tr><tr><td align="right">0c.</td><td>Manual Testing Guide</td><td>Manual testing guide with steps for using the application, with examples including expected inputs and outputs</td></tr><tr><td align="right">1.</td><td>Raw Indexing</td><td>BigQuery Index substrate-etl.crypto_polkadot.traces0 9/1/2023-10/31/23 -- stashing accounts</td></tr><tr><td align="right">2.</td><td>Deep Indexing</td><td>BigQuery substrate-etl:substrate.democracy<em>* substrate-etl:substrate.staking</em><em> substrate-etl:substrate.nomination<em>pools</em></em></td></tr><tr><td align="right">3.</td><td>Dashboard Publication</td><td>Superset dashboard tabs: &quot;Democracy&quot;, &quot;Staking&quot;, &quot;Nomination Pools&quot;</td></tr></tbody></table><p>We will take this opportunity to address the complexity of stashing accounts by:</p><ul><li>Deep Indexing.  Using the above tables in the views referencing  <code>storage_staking_*, storage_nominationpools_*</code> tables</li><li>Dashboard Publication.  Using the above, we can develop dashboards for Democracy+Staking+Nomination Pools</li></ul><p>Indexing + Dashboard Publication must be able to support deep analysis of Democracy and Staking/Nomination Pools pallets:</p><ul><li>Democracy: Which accounts have delegated OpenGov votes to an account or to which accounts the account in question has delegated their votes to for each track?</li><li>Staking/Nomination Pools: Who are all the nominators that nominated Validator X? (an inverse mapping basically of staking.nominators from validator -&gt; nominators)  Who are the top 10 nominators with the highest APR, and which validators do they have in common?</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="future-plans">Future Plans<a href="#future-plans" class="hash-link" aria-label="Direct link to Future Plans" title="Direct link to Future Plans">â€‹</a></h2><p>Broadly, this proposal sets up a path for the Web3 Foundation to have Polkadot Data Alliance contributors deliver results for the Web3 Foundation itself and the community in the following ways:</p><ol><li><p>within the three-tier architecture, Polkadot Data Alliance contibutors can collaborate with Web3 Foundation and others in the Substrate community using raw indexes, published deep indexes, or building and extending dashboards.  Our technical choice for collaboration is BigQuery and Apache Superset but other choices may be equally viable or appropriate, by other teams.  </p></li><li><p>with the <a href="https://docs.google.com/document/d/1fA5ARHy-frzgZC66rniKZ5o7CSbDvCTkS--kWaMzuMs/edit#" target="_blank" rel="noopener noreferrer">Polkadot Data Alliance Bounty</a> and the <a href="https://github.com/w3f/Grants-Program#hammer_and_wrench-maintenance-grants" target="_blank" rel="noopener noreferrer">Web3 Foundation Maintance Grants</a>, there is a clear path to support both software maintainence <em>and</em> hosting / data indexing infrastructure </p></li></ol><p>In followup work, we would expect to address the 3 tiers:</p><ul><li>raw indexing: cover traces on a regular basis defined in child bounties</li><li>deep indexing: support the dataset deliverables on a regular basis </li><li>dashboards: maintain published dashboards developed, and host the Apache Superset</li></ul><p>We would welcome the challenge of doing followon high impact work, but hope that others in the Polkadot Data Alliance can follow this model as well.</p><p>We propose a child bounty to host Apache Superset instance at <a href="https://analytics.polkadot.network" target="_blank" rel="noopener noreferrer">https://analytics.polkadot.network</a> or transfer this responsibility to a parent bounty curator.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-information-">Additional Information âž•<a href="#additional-information-" class="hash-link" aria-label="Direct link to Additional Information âž•" title="Direct link to Additional Information âž•">â€‹</a></h2><p>We request suitable Web3 Foundation members be identified as parent
and child bounty curator candidates, and that the charter for the
Polkadot Data Alliance be developed in a collaboration with Parity.
The Polkadot Data Alliance charter is <a href="https://docs.google.com/document/d/1fA5ARHy-frzgZC66rniKZ5o7CSbDvCTkS--kWaMzuMs/edit#" target="_blank" rel="noopener noreferrer">here</a>.</p><p>We do not believe our participation (or anyone else&#x27;s participation)
in a Polkadot Data Alliance in providing deliverables at any of the
three tiers eliminates the possibility of doing further data
processing for other sources of additional revenue.  Our goal is to be
self-sufficient and not dependent on W3F Grants or Treasury funding,
but we hope our value and commitment to sharing and collaboration is
recognized by the community so we can be productive high impact
contributors.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/w3f/Grants-Program/edit/master/applications/DeepAccountAnalytics-PolkadotDataAlliance.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract-" class="table-of-contents__link toc-highlight">Abstract ðŸ“„</a></li><li><a href="#project-overview-" class="table-of-contents__link toc-highlight">Project Overview ðŸ“„</a><ul><li><a href="#project-details" class="table-of-contents__link toc-highlight">Project Details</a></li><li><a href="#ecosystem-fit" class="table-of-contents__link toc-highlight">Ecosystem Fit</a></li></ul></li><li><a href="#team-" class="table-of-contents__link toc-highlight">Team ðŸ‘¥</a><ul><li><a href="#team-members--contact" class="table-of-contents__link toc-highlight">Team members / Contact</a></li><li><a href="#legal-structure" class="table-of-contents__link toc-highlight">Legal Structure</a></li><li><a href="#teams-experience" class="table-of-contents__link toc-highlight">Team&#39;s experience</a></li><li><a href="#team-code-repos" class="table-of-contents__link toc-highlight">Team Code Repos</a></li></ul></li><li><a href="#development-status-" class="table-of-contents__link toc-highlight">Development Status ðŸ“–</a></li><li><a href="#development-roadmap-" class="table-of-contents__link toc-highlight">Development Roadmap ðŸ”©</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#milestone-1--three-tier-deep-account-analytics-on-account-references" class="table-of-contents__link toc-highlight">Milestone 1 â€” Three Tier Deep Account Analytics on Account References</a></li><li><a href="#milestone-2--three-tier-deep-account-analysis-of-democracystakingnomination-pools" class="table-of-contents__link toc-highlight">Milestone 2 â€” Three Tier Deep Account Analysis of Democracy+Staking+Nomination Pools</a></li></ul></li><li><a href="#future-plans" class="table-of-contents__link toc-highlight">Future Plans</a></li><li><a href="#additional-information-" class="table-of-contents__link toc-highlight">Additional Information âž•</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More Info</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/w3f/Grants-Program" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://web3.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/Support Docs/privacy_policy">Privacy Policy</a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/Web3foundation" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://matrix.to/#/!XpynPDLusWUWfDpaqr:matrix.org?via=web3.foundation&amp;via=matrix.org&amp;via=matrix.parity.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Grants Community Matrix Channel<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2023 Web3 Foundation</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3bea6f0c.js"></script>
<script src="/assets/js/main.61fc85c3.js"></script>
</body>
</html>